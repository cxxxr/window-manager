(in-package :liwm)

(defun main (&key display)
  (start-window-manager
   (make-window-manager display)
   :initialized-hook (lambda ()
                       (bind-key (make-key-input "t" :meta t :control t)
                                 (lambda () (run-program "xterm" :wait nil)))
                       (bind-key (make-key-input "n" :super t)
                                 (lambda () (focus-next-window)))
                       (bind-key (make-key-input "p" :super t)
                                 (lambda () (focus-previous-window)))
                       (bind-key (make-key-input "F4" :meta t)
                                 (lambda ()
                                   (alexandria:when-let (window (current-window *window-manager*))
                                     (quit-window window))))
                       (bind-key (make-key-input "x" :super t)
                                 (lambda ()
                                   (alexandria:when-let (window (current-window *window-manager*))
                                     (toggle-maximize-window window))))
                       (bind-key (make-key-input "a" :super t)
                                 (lambda () (add-vdesk)))
                       (bind-key (make-key-input "2" :super t)
                                 (lambda () (change-to-vdesk (second (vdesks *window-manager*)))))
                       (bind-key (make-key-input "1" :super t)
                                 (lambda () (change-to-vdesk (first (vdesks *window-manager*))))))))
